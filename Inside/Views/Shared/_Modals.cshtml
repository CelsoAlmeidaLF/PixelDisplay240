<!-- TOAST NOTIFICATIONS -->
<div id="toast-error-container"></div>
<div id="toast-success-container"></div>

<!-- MODALS -->
<div id="export-modal" class="modal">
    <div class="modal-content">
        <h2>Exportar</h2>
        <textarea id="output-text" readonly></textarea>
        <div class="header-actions" style="justify-content: flex-end; gap: 8px;">
            <button id="btn-download-bmp" class="secondary-btn small-btn">BMP</button>
            <button id="btn-download-jpg" class="secondary-btn small-btn">JPG</button>
            <button id="btn-download-bin" class="secondary-btn small-btn">BIN</button>
            <button id="btn-download" class="primary-btn">Download .h</button>
            <button id="btn-close-modal" class="text-btn">Fechar</button>
        </div>
    </div>
</div>

<div id="help-modal" class="modal" style="display:none;">
    <div class="modal-content">
        <h2>Guia PixelDisplay240</h2>
        <p>Atalhos: Ctrl+Z (Undo), Ctrl+Y (Redo), Alt (Picker).</p>
        <button id="btn-close-help" class="primary-btn">Fechar</button>
    </div>
</div>

<div id="font-modal" class="modal" style="display:none;">
    <div class="modal-content">
        <h2>Gerador de Fontes</h2>
        <input type="text" id="font-family" value="Arial">
        <input type="number" id="font-size" value="16">
        <textarea id="font-output" readonly></textarea>
        <button id="btn-gen-font" class="primary-btn">Gerar</button>
        <button id="btn-close-font" class="text-btn">Fechar</button>
    </div>
</div>

<div id="custom-dialog" class="modal" style="display:none;">
    <div class="modal-content" style="max-width: 420px; text-align: center;">
        <div id="dialog-icon" style="margin-bottom: 1rem;"></div>
        <h3 id="dialog-title" style="margin-bottom: 0.5rem;"></h3>
        <p id="dialog-message" style="color: var(--text-muted); margin-bottom: 1.5rem; font-size: 0.9rem;"></p>
        <input type="text" id="dialog-input" style="display:none; margin-bottom: 1rem; text-align: center;">
        <div style="display: flex; gap: 10px; justify-content: center;">
            <button id="dialog-cancel" class="secondary-btn" style="display:none; min-width: 100px;">Cancelar</button>
            <button id="dialog-confirm" class="primary-btn" style="min-width: 100px;">OK</button>
        </div>
    </div>
</div>


<!-- AI PIXEL ART GENERATOR MODAL -->
<div id="ai-modal" class="modal" style="display:none;">
    <div class="modal-content" style="max-width: 600px;">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 1.5rem;">
            <div style="width: 44px; height: 44px; border-radius: 12px; background: linear-gradient(135deg, #8b5cf6, #ec4899); display: flex; align-items: center; justify-content: center;">
                <i data-lucide="sparkles" style="width:24px; height:24px; color: white;"></i>
            </div>
            <div>
                <h2 style="margin: 0; font-size: 1.2rem;">AI Pixel Art Generator</h2>
                <p style="margin: 0; font-size: 0.75rem; color: var(--text-muted);">Powered by Gemini</p>
            </div>
            <button class="text-btn" style="margin-left: auto;" onclick="document.getElementById('ai-modal').style.display='none'">✕</button>
        </div>

        <div class="input-field">
            <span>Descreva a imagem que deseja gerar:</span>
            <textarea id="ai-prompt" style="height: 80px; resize: vertical; font-size: 0.9rem; color: white; background: var(--bg-dark);" placeholder="Ex: um gato pixel art com fundo azul, estilo retro 8-bit..."></textarea>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
            <div class="input-field">
                <span>Tamanho do Pixel</span>
                <select id="ai-pixel-size">
                    <option value="1">1px (Original)</option>
                    <option value="2">2px (Suave)</option>
                    <option value="4" selected>4px (Pixel Art)</option>
                    <option value="8">8px (Retro)</option>
                    <option value="12">12px (Chunky)</option>
                </select>
            </div>
            <div class="input-field">
                <span>Paleta de Cores</span>
                <select id="ai-palette">
                    <option value="full">Todas as cores</option>
                    <option value="16">16 cores (Retro)</option>
                    <option value="8">8 cores (Mínimo)</option>
                    <option value="4">4 cores (GameBoy)</option>
                    <option value="2">2 cores (Monocromático)</option>
                </select>
            </div>
        </div>

        <div id="ai-preview" style="display: none; margin-bottom: 1rem; text-align: center;">
            <canvas id="ai-preview-canvas" width="240" height="240" style="border: 2px solid var(--border); border-radius: 8px; image-rendering: pixelated; max-width: 240px;"></canvas>
            <p style="font-size: 0.7rem; color: var(--text-muted); margin-top: 0.5rem;">Preview 240×240</p>
        </div>

        <div id="ai-loading" style="display: none; text-align: center; padding: 2rem;">
            <div style="width: 48px; height: 48px; border: 4px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
            <p style="color: var(--text-muted);">Gerando imagem com IA...</p>
            <p style="font-size: 0.7rem; color: var(--text-muted);">Isso pode levar alguns segundos</p>
        </div>

        <div style="display: flex; gap: 10px; justify-content: flex-end;">
            <button class="secondary-btn" onclick="document.getElementById('ai-modal').style.display='none'">Cancelar</button>
            <button id="btn-ai-generate" class="primary-btn" onclick="generateAIPixelArt()" style="background: linear-gradient(135deg, #8b5cf6, #ec4899);">
                <i data-lucide="sparkles" style="width:16px;"></i> Gerar Pixel Art
            </button>
            <button id="btn-ai-apply" class="primary-btn" style="display:none;" onclick="applyAIToCanvas()">
                <i data-lucide="check" style="width:16px;"></i> Aplicar no Canvas
            </button>
        </div>
    </div>
</div>

<!-- AGENT CONFIG MODAL -->
<div id="agent-modal" class="modal" style="display:none;">
    <div class="modal-content" style="max-width: 520px;">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 1.5rem;">
            <div style="width: 44px; height: 44px; border-radius: 12px; background: linear-gradient(135deg, #0ea5e9, #22d3ee); display: flex; align-items: center; justify-content: center;">
                <i data-lucide="settings" style="width:24px; height:24px; color: white;"></i>
            </div>
            <div>
                <h2 style="margin: 0; font-size: 1.2rem;">Configuracao de Agentes</h2>
                <p style="margin: 0; font-size: 0.75rem; color: var(--text-muted);">Chaves para integracoes</p>
            </div>
            <button id="btn-agent-close" class="text-btn" style="margin-left: auto;">✕</button>
        </div>

        <div class="agent-form">
            <div class="input-field">
                <span>Chave de Acesso API</span>
                <input type="password" id="agent-access-key" placeholder="Cole a chave de acesso" />
            </div>
            <div class="input-field">
                <span>Gemini API Key</span>
                <input type="password" id="agent-gemini-key" placeholder="Cole sua chave Gemini" />
            </div>
        </div>

        <div class="agent-actions">
            <button id="btn-agent-save" class="primary-btn">Salvar</button>
        </div>
    </div>
</div>
